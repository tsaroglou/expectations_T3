{% extends "global/Page.html" %}
{% load otree static %}

{% block head %}
  <link rel="stylesheet" href="{% static 'Voted_Risk/styles.css' %}">
  <style>
    .matrix-container {
      display: flex; justify-content: space-around; gap: 20px;
      margin-bottom: 1.5rem;
    }
    .matrix-section {
      width: 45%; text-align: center;
    }
    .game-label {
      text-align: center; font-weight: bold; font-size: 18px;
      margin: 8px 0 16px;
    }
    .axis-label { font-weight: bold; }
    .you     { color: red;   font-weight: bold; }
    .partner { color: blue;  font-weight: bold; }
    table span.partner { opacity: 0.3; }

    .feedback-correct   { color: green; margin-bottom: 1rem; }
    .feedback-incorrect { color: red;   margin-bottom: 1rem; }
    .question-feedback  { margin-bottom: 2rem; }
  </style>
{% endblock head %}

{% block content %}
<div class="container">
  <h1>Comprehension Feedback</h1>
  <p>Review your answers below, then click “Next” to continue.</p>

  <div class="matrix-container">
    <!-- Game 1 -->
    <div class="matrix-section">
      <div class="game-label">Game 1</div>
      <table class="payoff-matrix">
        <thead>
          <tr>
            <th rowspan="2" class="axis-label" style="color:red">Your Action</th>
            <th colspan="2" class="axis-label" style="color:blue;opacity:0.3">Partner’s Action</th>
          </tr>
          <tr>
            <th style="color:blue;opacity:0.3">A</th>
            <th style="color:blue;opacity:0.3">B</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th style="color:red">A</th>
            <td><span class="you">3</span>, <span class="partner">3</span></td>
            <td><span class="you">1</span>, <span class="partner">4</span></td>
          </tr>
          <tr>
            <th style="color:red">B</th>
            <td><span class="you">4</span>, <span class="partner">1</span></td>
            <td><span class="you">2</span>, <span class="partner">2</span></td>
          </tr>
        </tbody>
      </table>
    </div>
    <!-- Game 2 -->
    <div class="matrix-section">
      <div class="game-label">Game 2</div>
      <table class="payoff-matrix">
        <thead>
          <tr>
            <th rowspan="2" class="axis-label" style="color:red">Your Action</th>
            <th colspan="2" class="axis-label" style="color:blue;opacity:0.3">Partner’s Action</th>
          </tr>
          <tr>
            <th style="color:blue;opacity:0.3">A</th>
            <th style="color:blue;opacity:0.3">B</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th style="color:red">A</th>
            <td><span class="you">5</span>, <span class="partner">5</span></td>
            <td><span class="you">0</span>, <span class="partner">7</span></td>
          </tr>
          <tr>
            <th style="color:red">B</th>
            <td><span class="you">7</span>, <span class="partner">0</span></td>
            <td><span class="you">2</span>, <span class="partner">2</span></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  {% for q in questions %}
    <div class="question-feedback">
      <p><strong>{{ q.label }}</strong></p>
      {% if q.selected == q.correct %}
        <p class="feedback-correct">Your answer: {{ q.selected }} ✓</p>
      {% else %}
        <p class="feedback-incorrect">Your answer: {{ q.selected }} ✗</p>
        <p class="feedback-incorrect">{{ q.explanation }}</p>
        <p class="feedback-correct">Correct answer: {{ q.correct }}</p>
      {% endif %}
    </div>
  {% endfor %}

  <hr>
  {% next_button %}
</div>
{% endblock content %}
